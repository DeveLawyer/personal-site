---
title: Presentando Contentz
description: Contentz, un Pure Static Site Generator para obtener un sitio web super optimizado
date: 2019-03-05T21:03:17.909Z
published: true
lang: es
tags: Contentz, SSG, Spanish, Website
---

Hace unos d칤as escrib칤 sobre [que esperar칤a de mi generador de sitios est치ticos ideal](/articles/generador-sitios-estaticos-propio), hoy presento [**Contentz**](https://github.com/sergiodxa/contentz). Lo llamo un Pure Static Site Generator porque solo usa JavaScript en el navegador para crear un Service Worker m칤nimo que se encarga de guardar en cache todo el sitio.

## Empezando a usarlo

Para usar Contentz lo primero es instalarlo, se puede instalar usando _npm_

```bash
npm install contentz
```

O tambi칠n usando yarn.

```bash
yarn add contentz
```

Una vez instalado hay que crear un archivo de configuraci칩n (muy peque침o) con la siguiente informaci칩n.

```yml
---
title: Sergio Xalambr칤
description: Senior Software Engineer and Technical Writer
domain: https://sergiodxa.com
```

En este archivo se agrega el t칤tulo del sitio, la descripci칩n y el dominio donde va a estar alojado (necesario para el feed RSS). Una vez hecho esto hay que crear una carpeta `articles` y/o una carpeta `pages`. Ambas son opcionales, puede haber art칤culos sin p치ginas personalizadas o p치ginas personalizadas sin art칤culos.

Ya con las carpetas creadas hay que decirle a Contentz que construya el sitio web.

```bash
contentz build
```

Con esto Contentz lee los art칤culos y p치ginas y va a crear una carpeta `/public` en el proyecto con el HTML de cada una, adem치s va a generar un `index.html` y un `/public/articles/index.html` donde se van a listar todos los art칤culos.

Eso es todo, ahora solo es necesario desplegar nuestra carpeta `/public` a un servidor para que est칠 online, para esto pueden usar [Netlify](https://netlify.com).

## Escribe en MDX, publica en HTML optimizado

Contentz usa MDX para tu contenido junto a Frontmatter para la metadata, un ejemplo de art칤culo ser칤a este.

```markdown
---
title: Presentando Contentz
description: Contentz, un Pure Static Site Generator para obtener un sitio web super optimizado
date: 2019-03-05T21:03:17.909Z
published: true
lang: es
tags: Contentz, SSG, Spanish, Website
---

Hace unos d칤as escrib칤 sobre [que esperar칤a de mi generador de sitios est치ticos ideal](/articles/generador-sitios-estaticos-propio), hoy presento [Contentz](https://github.com/sergiodxa/contentz). Lo llamo un Pure Static Site Generator porque solo usa JavaScript en el navegador para crear un Service Worker m칤nimo que se encarga de guardar en cache todo el sitio.
```

Contentz lee este contenido y lo renderiza a HTML al momento de construir el sitio. Durante este proceso obtiene todos los enlaces a contenido del mismo sitio (como `/articles/generador-sitios-estaticos-propio` en el ejemplo) y agrega una etiqueta `<link rel="prefetch" href="/articles/generador-sitios-estaticos-propio" />`, esto le dice al navegador que tiene que hacer prefetch de la p치gina, lo que significa que cuando una persona haga click en el enlace va a cargar inmediatamente ya que, en realidad, el navegador ya descarg칩 el HTML en background.

Otra detalle especial es que todo el CSS est치 en etiquetas `<style>` directo en el HTML y el 칰nico archivo JavaScript que se carga es para el Service Worker que se genera, esto hace que la carga sea mucho m치s r치pida al no necesitar ejecutar mucho JavaScript en el navegador o descargar hojas de estilos CSS.

## Construye el sitio de forma incremental

Algo que siempre me molest칩 de otros generadores de sitios est치ticos es que cada vez que necesito construir el sitio lo hace desde cero, aunque solo cambi칩 un archivo. En cambio, Contentz, al tener control de todo el dise침o y limitarte a escribir art칤culos y p치ginas puede f치cilmente detectar que cambi칩 y solo generar el HTML de las p치ginas afectadas.

Esto permite ir construyendo el sitio web de forma incremental. 游뱚

En caso de que se desee deshabilitar esta funcionalidad simplemente hay que agregar al `config.yml` la regla `incremental: false` (en caso de ser `true` o no existir est치 habilitado). Esto puede ser 칰til para forzar a regenerar todo el sitio o por si tu hosting guarda cache la carpeta `.cache`, usada por Contentz para saber que cambi칩, pero no `/public` para guardar el HTML creado anteriormente.

## Compartir enlaces

Algo que me gusta mucho es [compartir enlaces de sitios web interesantes que leo](/links/), Contentz soporta esta funcionalidad permiti칠ndome crear un archivo `links.yml` con un c칩digo similar a este.

```yml
---
- url: https://htmlreference.io/
  title: HTML Reference
  comment: An incredible and complete guide of all the HTML tags with visual examples
  date: 2019-01-28T19:44:10.945Z
```

Al decirle a Contentz que construya un sitio web este va a crear una lista, similar a la de art칤culos, en `/links/` con todos los enlaces que existan en este archivo. Adem치s va a agregar un enlace autom치ticamente en el header llamado `Link` que apunte a esta p치gina y se va a encargar de hacerle prefetch autom치ticamente.

## Offline First autom치tico

Contentz genera un Service Worker con un c칩digo m칤nimo, para ser exactos con este c칩digo

```js
importScripts("https://storage.googleapis.com/workbox-cdn/releases/4.0.0/workbox-sw.js"),workbox&&workbox.routing.registerRoute(o=>location.origin&&o.url.origin&&"/load-sw.js"!==o.url.pathname&&"/sw.js"!==o.url.pathname,new workbox.strategies.NetworkFirst);
```

Ese c칩digo lo que hace es guardar en cache todas las peticiones HTTP que se hagan al mismo sitio excepto `/load-sw.js` y `/sw.js`, ya que no queremos cachear nuestro Service Worker y tener problemas al actualizar luego. Una vez guardados en cache siempre que el usuario tenga conexi칩n a internet va a mandar una petici칩n HTTP normal y responderle al usuario con lo que mande el servidor, pero en caso de que el usuario pierda su acceso a internet va a responder con la cache.

Esto significa que el usuario una vez acceda a la p치gina pueder volver a verla incluso si est치 offline. Gracias al uso de prefetch el usuario tambi칠n puede acceder a otras p치ginas que no entr칩 directamente ya que el navegador ya las pidi칩 antes y por tanto el Service Worker ya las guard칩 en cache, por ejemplo si el usuario accede a la lista de art칤culos en `/articles/` entonces el Service Worker va a tener en cache todos los art칤culos para acceso offline, si no tienen im치genes o nada externo el usuario deber칤a poder navegar por el sitio offline sin problemas.

## Feed RSS

Aunque muchos no lo usan, personalmente me gusta mucho RSS para enterarme de nuevos art칤culos en blogs que sigo. Por eso es que Contentz lee todos tus art칤culos y genera un feed RSS en `/atom.xml` con la lista, encaso de que cambie un archivo se generar칤a de nuevo el feed RSS con los art칤culos nuevos o actualizados.

## Archivos est치ticos

Usar archivos est치ticos tambi칠n es algo com칰n en cualquier sitio web, para poner im치genes por ejemplo. Contentz soporta esto permitiendo que crees una carpeta `/static` con tu contenido est치tico, dentro puede haber cualquier archivo o carpeta, Contentz simplemente va a copiar todo `/static` a `/public/static`, de forma que si en un art칤culo o p치gina se carga una im치gen la carpeta `/static` va a existir dentro de `/public` correctamente.

## Generador de im치genes sociales

Algo super tedioso al publicar un blog es crear im치genes sociales, un Open Graph b치sicamente, al punto de que hist칩ricamente o no ten칤a un Open Graph o estaba usando uno gen칠rico, Contentz tiene una funci칩n para generar estos Open Graph por si solo, para esto hay que ejecutar el siguiente comando.

```bash
contentz social <path>
```

Donde `<path>` es el archivo cuyo Open Graph queremos generar, por ejemplo `contentz social articles/hello-world.mdx` va a generar el Open Graph del art칤culo `hello-world.mdx`

Para las p치ginas especiales es necesario tambi칠n ejecutarlo, pero en estos casos usando nombres fijos que son

- home
- error
- articles/archive (ambos funcionan)
- links

Entonces al iniciar un sitio ser칤a necesario ejecutar `contentz social home error articles links` al menos una vez, como pueden ver adem치s es posible pasar m치s de un archivo a la vez.

Todas las im치genes generadas por Contentz van a estar ubicadas en `/static/_social` y todos los art칤culos autom치ticamente cargan su Open Graph desde las carpetas correctas sin tener que hacer nada, as칤 que una vez generado el Open Graph ya va a funcionar de una.

## Estilos directo en MDX

Otra posibilidad de MDX es agregar estilos directo en tu MDX, internamente Contentz usa [Emotion](https://emotion.sh/) para el CSS y carga tanto `jsx` como el template literal `css` por lo que es posible estilizar de dos formas.

```jsx
<div css={{ color: "red" }}>This is red</div>
<div css={css`color: blue`}>This is blue</div>
```

Ya sea usando el prop `css` con un objeto o con el resultado del template literal `css` para poner CSS usando la sintaxis normal de CSS, ambos casos funcionan y permiten agregar estilos a elementos directo en el MDX.

## P치ginas especiales

Como ya mencion칠 en otras partes, hay ciertas p치ginas especiales, estas son `/` (la home), `/articles/` (la lista de art칤culos), `/links/` (la lista de enlaces compartidos) y `/404.html` (la p치gina de error). Estas p치ginas se generan solas sin que tengas que escribir nada.

### Home (`/`)

Esta p치gina se genera siempre, sirve de p치gina de inicio, usa el `title` y `description` de tu `config.yml` para mostrarlos en el contenido. Se pueden agregar adem치s links a redes sociales agregando la siguiente configuraci칩n

```yml
social:
  twitter: sergiodxa
  github: sergiodxa
  npm: sergiodxa
  linkedin: sergiodxa
  dev: sergiodxa
  meetup: 182915204
```

Esa adem치s es la lista de redes sociales soportadas actualmente. Adicionalmente es posible `email: hello@sergiodxa.com` al `config.yml` para que se agregue junto a las redes sociales un 칤cono de email.

### Lista de art칤culos (`/articles/`)

La lista de art칤culos es bien simple, se genera autom치ticamente con todos los art칤culos que tengan `published: true` en su frontmatter, eso es todo lo que se puede modificar de la lista, con solo tener un art칤culo alcanza para que se genere y siempre est치 enlazada en el header.

### Lista de enlaces (`/links/`)

Similar a la lista de art칤culos la lista de enlaces no tiene mucha configuraci칩n, solo agregar un `links.yml` y se va a generar con los enlaces, cada enlaces en dicho archivo se agrega.

### Error 404 (`/404.html`)

Esta p치gina se genera para poder manejar los 404 con un dise침o acorde al resto del sitio y enlaces a otras secciones. Se genera solo sin necesidad de configurar nada, aunque es probable que en el proveedor de hosting sea necesario configurar que muestre este archivo en caso de no encontrar alguna p치gina.

## Enlace a Patreon

Yo tengo un [Patreon](https://sdx.im/link/https://patreon.com/sergiodxa) donde a qui칠n le gusten mis art칤culos o el contenido que creo pueden apoyarme monetariamente. Como esto es algo cada vez m치s com칰n Contentz soporta esto y permite agregar `patreon: sergiodxa` al archivo `config.yml` para que se agregue en la home y al final de cada p치gina y art칤culo un mensaje con el enlace a Patreon.

## Editar en GitHub

Mi sitio personal [est치 en GitHub en un repositorio p칰blico](https://github.com/sergiodxa/personal-site), y en caso de querer editarlo o que alguien que lo lea quiere editar es posible simplemente mandar un Pull Request con los cambios. Contentz tambi칠n soporta este caso y permite agregar `repository: https://github.com/sergiodxa/personal-site/` al `config.yml` para mostrar un enlace al final de cada art칤culo o p치gina que dice `Editor on GitHub` para sugerir poder editarlo y enlaza directo al respositorio en el archivo correcto.

## Navegaci칩n

El header es generado solo con el enlace a `/links/` y a la lista de art칤culos en `/articles/`, en caso de tener p치ginas personalizadas o querer enlazar a alg칰n otro lado se pueden agregar enlaces extras en el `config.yml` agregando

```yml
navigation:
  - name: Services
    path: /services/
```

Cada grupo de `name` y `path` va a ser un enlace en el header.

## Palabras finales

Contentz no es un trabajo 100% terminado, pero estoy bastante contento con el resultado, en todas las pruebas que hice el sitio carga muy r치pido y pase de tardar minutos en hacer deploy de mi sitio a segundos, con la funcionalidad de incremental activada incluso **춰Menos de un segundo!** Eso es muy r치pido a comparaci칩n.
